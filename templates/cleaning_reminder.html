<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>ğŸ§¼ ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø«Ù„Ø§Ø¬Ø©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #f5faff;
      --text: #333;
      --box-bg: #e0f7ff;
      --box-border: #00bfff;
      --alert-bg: #fff3cd;
      --alert-text: #856404;
      --button-bg: #28a745;
      --button-hover: #218838;
    }

    [data-theme="dark"] {
      --bg: #121212;
      --text: #eee;
      --box-bg: #1e1e1e;
      --box-border: #008ecc;
      --alert-bg: #554c00;
      --alert-text: #f3d367;
      --button-bg: #1e7e34;
      --button-hover: #155d27;
    }

    body {
      background-color: var(--bg);
      color: var(--text);
      font-family: 'Cairo', sans-serif;
      direction: rtl;
      text-align: center;
      padding: 40px 20px;
      transition: background 0.3s ease, color 0.3s ease;
    }

    h1 {
      color: #007acc;
      font-size: 32px;
      margin-bottom: 20px;
    }

    .countdown, .history, .old-count {
      font-size: 20px;
      background: var(--box-bg);
      border: 2px dashed var(--box-border);
      padding: 20px;
      border-radius: 12px;
      max-width: 500px;
      margin: 20px auto;
    }

    .old-products {
      background-color: var(--alert-bg);
      color: var(--alert-text);
      border: 1px solid #ffeeba;
      padding: 20px;
      border-radius: 10px;
      max-width: 500px;
      margin: 30px auto;
    }

    button {
      padding: 12px 20px;
      font-size: 16px;
      background-color: var(--button-bg);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 20px;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: var(--button-hover);
    }
  </style>
</head>
<body>
  <h1>ğŸ§¼ Ø¬Ø¯ÙˆÙ„ ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø«Ù„Ø§Ø¬Ø©</h1>

  <div class="countdown">
    Ø§Ù„ØªØ§Ù„ÙŠ: <span id="daysLeft"></span> ÙŠÙˆÙ… Ø¹Ù„Ù‰ Ù…ÙˆØ¹Ø¯ Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù‚Ø§Ø¯Ù… ğŸ§½
  </div>

  <div class="old-count">
    ğŸ” ÙŠÙˆØ¬Ø¯ <span id="oldProductCount">0</span> Ù…Ù†ØªØ¬Ù‹Ø§ Ù‚Ø¯ÙŠÙ…Ù‹Ø§ ÙÙŠ Ø§Ù„Ø«Ù„Ø§Ø¬Ø© Ø­Ø§Ù„ÙŠØ§Ù‹.
  </div>

  <div class="old-products">
    <strong>ğŸ¦¿ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù†Ø¸Ø§ÙØ©:</strong>
    <ul id="cleaningTips"></ul>
    <button onclick="showRandomTips()">ğŸ” Ù†ØµØ§Ø¦Ø­ Ø¬Ø¯ÙŠØ¯Ø©</button>
  </div>

  <div class="history">
    ğŸ“… Ø³Ø¬Ù„ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ:
    <ul id="cleaningHistory"></ul>
  </div>

  <button onclick="resetCleaningDate()">âœ… ØªÙ… ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø«Ù„Ø§Ø¬Ø© Ø§Ù„ÙŠÙˆÙ…</button>

  <script>
    const tips = [
      "ğŸ§€ Ø§Ù„Ø¬Ø¨Ù† Ø§Ù„Ù…Ø®Ø²Ù‘Ù† Ù„ÙØªØ±Ø© Ø·ÙˆÙŠÙ„Ø© Ù‚Ø¯ ÙŠØ³Ø¨Ø¨ Ø±Ø§Ø¦Ø­Ø© Ø£Ùˆ Ù†Ù…Ùˆ Ø¹ÙÙ†.",
      "ğŸ¥¬ ØªØ£ÙƒØ¯ Ù…Ù† ÙØ­Øµ Ø§Ù„Ø®Ø³ Ø£Ùˆ Ø§Ù„ÙˆØ±Ù‚ÙŠØ§Øª Ù„Ø£Ù†Ù‡Ø§ ØªØ°Ø¨Ù„ ÙˆØªØ³Ø¨Ø¨ Ø±Ø§Ø¦Ø­Ø©.",
      "ğŸ¥« Ø§Ù„ØµÙˆØµØ§Øª Ø§Ù„Ù…ÙØªÙˆØ­Ø© Ø¯ÙˆÙ† ØºØ·Ø§Ø¡ Ù…Ø­ÙƒÙ… Ù‚Ø¯ ØªÙ„ÙˆØ« Ø§Ù„Ø±ÙÙˆÙ.",
      "ğŸ— Ø§Ù„Ù„Ø­ÙˆÙ… Ø§Ù„Ù†ÙŠØ¦Ø© Ø£Ùˆ ØºÙŠØ± Ø§Ù„Ù…ØºÙ„ÙØ© Ø¬ÙŠØ¯Ù‹Ø§ ØªØ³Ø¨Ø¨ Ø§ØªØ³Ø§Ø® ÙÙŠ Ø§Ù„Ø£Ø¯Ø±Ø§Ø¬.",
      "ğŸ§ƒ Ø§Ù„Ø¹ØµØ§Ø¦Ø± Ø§Ù„Ù…ÙƒØ´ÙˆÙØ© Ù‚Ø¯ ØªØ¬Ø°Ø¨ Ø§Ù„Ù†Ù…Ù„ Ø£Ùˆ ØªØ³Ø¨Ø¨ Ù„Ø²ÙˆØ¬Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¹.",
      "ğŸ¥¤ Ø§Ù„Ø¹Ù„Ø¨ Ø§Ù„Ù…Ù†Ø³ÙƒØ¨Ø© ØªØªØ±Ùƒ Ø·Ø¨Ù‚Ø© Ù„Ø²Ø¬Ø© ÙŠØµØ¹Ø¨ ØªÙ†Ø¸ÙŠÙÙ‡Ø§ Ù„Ø§Ø­Ù‚Ù‹Ø§.",
      "ğŸŒ Ø§Ù„ÙÙˆØ§ÙƒÙ‡ Ø§Ù„Ù†Ø§Ø¶Ø¬Ø© Ø¬Ø¯Ù‹Ø§ Ù‚Ø¯ ØªØ¬Ø°Ø¨ Ø§Ù„Ø°Ø¨Ø§Ø¨ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø«Ù„Ø§Ø¬Ø©.",
      "ğŸ¥– Ø§Ù„Ø®Ø¨Ø² Ø§Ù„Ù…ØªØ¹ÙÙ† ÙŠÙ†Ù‚Ù„ Ø§Ù„Ø±Ø§Ø¦Ø­Ø© Ù„Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª.",
      "ğŸ§… Ø§Ù„Ø¨ØµÙ„ ÙˆØ§Ù„Ø«ÙˆÙ… ÙŠØ¬Ø¨ ØªØ®Ø²ÙŠÙ†Ù‡Ù… ÙÙŠ ÙˆØ¹Ø§Ø¡ Ù…ØºÙ„Ù‚ Ù„ØªØ¬Ù†Ø¨ Ø§Ù†ØªØ´Ø§Ø± Ø§Ù„Ø±Ø§Ø¦Ø­Ø©.",
      "ğŸ§Š Ø§Ù„Ø£Ø¯Ø±Ø§Ø¬ ØªØ­ØªØ§Ø¬ Ù…Ø³Ø­ Ø¯ÙˆØ±ÙŠ Ù„Ù…Ù†Ø¹ ØªØ±Ø§ÙƒÙ… Ø§Ù„Ø³ÙˆØ§Ø¦Ù„.",
      "ğŸ§½ Ù„Ø§ ØªÙ†Ø³ ØªÙ†Ø¸ÙŠÙ Ù…Ù‚Ø¨Ø¶ Ø§Ù„Ø«Ù„Ø§Ø¬Ø© ÙÙ‡Ùˆ Ù…Ù† Ø£ÙƒØ«Ø± Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ù„Ù…Ø³Ù‹Ø§.",
      "ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ© ØªØ³Ø±Ù‘Ø¨ Ø³ÙˆØ§Ø¦Ù„ ÙˆØªØ³Ø¨Ø¨ Ø§ØªØ³Ø§Ø® Ø§Ù„Ø±ÙÙˆÙ.",
      "ğŸ¥« Ø§Ù„Ø¹Ù„Ø¨ Ø§Ù„Ù…Ø¹Ø¯Ù†ÙŠØ© Ø§Ù„Ù…ÙØªÙˆØ­Ø© ØªÙØ³Ø¨Ø¨ ØµØ¯Ø£ ÙˆØ±Ø§Ø¦Ø­Ø© ØºÙŠØ± Ù…Ø­Ø¨Ø¨Ø©.",
      "ğŸ§ˆ Ø§Ù„Ø²Ø¨Ø¯Ø© Ø§Ù„Ù…ÙƒØ´ÙˆÙØ© ØªØ£Ø®Ø° Ø±ÙˆØ§Ø¦Ø­ Ù…Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰.",
      "ğŸ¥© Ø³ÙˆØ§Ø¦Ù„ Ø§Ù„Ù„Ø­ÙˆÙ… Ù‚Ø¯ ØªØªØ³Ø±Ø¨ ÙˆØªØªØ¬Ù…Ø¹ Ø£Ø³ÙÙ„ Ø§Ù„Ø«Ù„Ø§Ø¬Ø©.",
      "ğŸ¥š Ø§Ù„Ø¨ÙŠØ¶ ØºÙŠØ± Ø§Ù„Ù…ØºØ³ÙˆÙ„ Ù‚Ø¯ ÙŠØ³Ø¨Ø¨ ØªÙ„ÙˆÙŠØ« Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø¬Ø§ÙˆØ±Ø©.",
      "ğŸ§¼ Ù…Ø³Ø­ Ø§Ù„Ø£Ø±ÙÙ Ø¨Ø§Ù†ØªØ¸Ø§Ù… ÙŠÙ…Ù†Ø¹ Ø§Ù„Ø±ÙˆØ§Ø¦Ø­ ÙˆÙŠØ²ÙŠØ¯ Ø¹Ù…Ø± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª.",
      "ğŸ“† ØªÙ†Ø¸ÙŠÙ Ø´Ù‡Ø±ÙŠ Ø´Ø§Ù…Ù„ ÙŠØ·ÙŠÙ„ Ø¹Ù…Ø± Ø§Ù„Ø«Ù„Ø§Ø¬Ø© ÙˆÙŠØ­Ø§ÙØ¸ Ø¹Ù„Ù‰ ÙƒÙØ§Ø¡ØªÙ‡Ø§.",
      "ğŸ§´ Ù‚Ø§Ø±ÙˆØ±Ø§Øª Ø§Ù„ØµÙˆØµ Ø§Ù„Ù„Ø²Ø¬Ø© ØªØ­ØªØ§Ø¬ Ù…Ø³Ø­ Ø®Ø§Ø±Ø¬ÙŠ Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø±.",
      "ğŸ‹ Ø§Ø³ØªØ®Ø¯Ù… Ø´Ø±Ø§Ø¦Ø­ Ø§Ù„Ù„ÙŠÙ…ÙˆÙ† Ø£Ùˆ Ø§Ù„ÙØ­Ù… Ù„Ø§Ù…ØªØµØ§Øµ Ø§Ù„Ø±ÙˆØ§Ø¦Ø­."
    ];

    function showRandomTips() {
      const ul = document.getElementById("cleaningTips");
      ul.innerHTML = "";
      const random = tips.sort(() => 0.5 - Math.random()).slice(0, 3);
      random.forEach(tip => {
        ul.innerHTML += `<li>${tip}</li>`;
      });
    }

    showRandomTips();

    const daysBetween = 7;
    const now = new Date();
    const lastCleaned = localStorage.getItem("last_cleaned_date");
    let lastDate = lastCleaned ? new Date(lastCleaned) : new Date();

    function updateCountdown() {
      const diffTime = now.getTime() - lastDate.getTime();
      const days = Math.max(0, daysBetween - Math.floor(diffTime / (1000 * 60 * 60 * 24)));
      document.getElementById("daysLeft").innerText = days;
    }

    function resetCleaningDate() {
      const now = new Date();
      localStorage.setItem("last_cleaned_date", now);

      let history = JSON.parse(localStorage.getItem("cleaning_history") || "[]");
      history.push(now.toLocaleString('ar-EG'));
      localStorage.setItem("cleaning_history", JSON.stringify(history));

      alert("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªÙ†Ø¸ÙŠÙ. Ø³ÙŠØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¹Ø¯Ø§Ø¯.");
      location.reload();
    }

    function loadCleaningHistory() {
      let history = JSON.parse(localStorage.getItem("cleaning_history") || "[]");
      const ul = document.getElementById("cleaningHistory");
      ul.innerHTML = history.slice(-5).reverse().map(date => `<li>${date}</li>`).join("");
    }

    function simulateOldProductCount() {
      fetch("/api/old_count")
        .then(res => res.json())
        .then(data => {
          document.getElementById("oldProductCount").innerText = data.count;
        });
    }

    updateCountdown();
    loadCleaningHistory();
    simulateOldProductCount();

    document.addEventListener("DOMContentLoaded", () => {
      const savedTheme = localStorage.getItem("theme");
      if (savedTheme === "dark") {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    });
  </script>
</body>
</html>
